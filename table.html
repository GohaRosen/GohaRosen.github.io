<!DOCTYPE HTML>
<html>
<head runat="server">
   <title>New task</title>
   <meta name="viewport" content="width=device-width,
      initial-scale=1" />
   <link href="bootstrap-3.3.6-dist/css/bootstrap.min.css" rel="stylesheet" />
</head>


<body>
     <table id="table" class="table table-striped">
      <tr id="tableRow">
        <th>Description</th>
        <th id="priorityButton">Task Priority</th> 
        <th id="dueDateButton">Due Date</th>
        <th id="deleteButton">Delete</th>
      </tr>
     </table>
      
     
       <footer class="navbar navbar-default navbar-fixed-bottom">
          <button class="btn btn-primary btn-lg btn-block" ><a href="new_task.html" type="button" class="btn btn-primary btn-lg btn-block" id="submit">Add new task </a></button>
        </footer>
  
  
  
<script type="text/javascript">
    
        window.onload = init;
        var myTaskObjects = new Array;
		
        function init()
		{
            
				var retrievedObject = window.localStorage.getItem("taskArray");  //read the local storage
				myTaskObjects = JSON.parse(retrievedObject);
				redoTable();
                    
          }
            
         document.getElementById("priorityButton").onclick=function(nsEvent)
		  {       																	 //sort function on priority button
            
                var theEvent = nsEvent ? nsEvent : window.event; 
                    
                    myTaskObjects.sort(function (a, b){
                        
                    return (a.priority.value - b.priority.value)});
        
                    redoTable();
                    
            }
                    
            document.getElementById("dueDateButton").onclick=function(nsEvent)
			{ 																	       //sort function on due Date button
            
                var theEvent = nsEvent ? nsEvent : window.event; 
                    
                    myTaskObjects.sort(function (a, b){
                        
                     a = new Date(a.dateModified);
                     b = new Date(b.dateModified);
                     return a>b ? -1 : a<b ? 1 : 0;});
        
                    redoTable();
                    
            }
                    
                
			function redoTable() 
			{										//function to print out the sorted table
            	var table = document.getElementById("table");	//access table
            
                for (var i = 0; i < myTaskObjects.length; i++)	
				{											//loop through the array
                
					var row = table.insertRow(1);					//create table row
					var cell1 = row.insertCell(0);					//create table cells
					var cell2 = row.insertCell(1);
					var cell3 = row.insertCell(2);
					var cell4 = row.insertCell(3);
					cell1.innerHTML = myTaskObjects[i].description;		//assign value from object to the cells
					cell2.innerHTML = myTaskObjects[i].priority;
					cell3.innerHTML = myTaskObjects[i].dueDate;
					cell4.innerHTML = '<button class="deleteButton" >DELETE</button>';
				   }
				}
        
        
             document.getElementById("table").addEventListener("click", deleteFunction);
                  
                  
              function deleteFunction(event)
			  {
                      var table = document.getElementById("table");
                      if(event.target.className == "deleteButton")
                          {
                              event.target.parentNode.parentNode.parentNode.removeChild(event.target.parentNode.parentNode);
                          }
       
               }	 
        
 </script>

</body>
</html>
